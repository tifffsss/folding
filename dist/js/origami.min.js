/*! origami 14-04-2014 */
var Origami=function(a){this.elt=a,this.sheetWidth=0,this.sheetHeight=0,this.deg=0,this.clonelimiteWidth=0,this.closeAll=function(){var a=this;console.log("length:",this.elt.children.length),Array.prototype.forEach.call(this.elt.children,function(){a.updateRotate3d(this.ref,this.translateX,this.translateY)})},this.updateRotate=function(a,b){a.style.webkitTransform="rotate("+b+"deg)",a.style.mozTransform="rotate("+b+"deg)",a.style.msTransform="rotate("+b+"deg)",a.style.oTransform="rotate("+b+"deg)",a.style.transform="rotate("+b+"deg)"},this.updateRotate3d=function(a,b,c){a.style.webkitTransform="rotate3d("+b+","+c+",0,90deg)",a.style.mozTransform="rotate3d("+b+","+c+",0,90deg)",a.style.msTransform="rotate3d("+b+","+c+",0,90deg)",a.style.oTransform="rotate3d("+b+","+c+",0,90deg)",a.style.transform="rotate3d("+b+","+c+",0,90deg)"},this.init=function(){var a=0,b=this;Array.prototype.forEach.call(this.elt.children,function(c){a++,c.id="sheet-"+a;var d=c.getAttribute("data-fold-type"),e=c.getAttribute("data-src"),f=this.ref=new Image;if(f.onLoad=function(){console.log("loaded"),f.style.opacity=1},f.src=e,c.appendChild(f),console.log(f.offsetWidth),d){var g=document.createElement("div");g.setAttribute("class","mask"),c.appendChild(g);var h=this.clonelimite=document.createElement("div");h.setAttribute("class","clone-limite"),c.appendChild(h);var i=this.clonerotate=document.createElement("div");i.setAttribute("class","clone-rotate"),h.appendChild(i);var j=this.clone=document.createElement("div");j.setAttribute("class","clone"),i.appendChild(j);var k=document.createElement("img");k.setAttribute("src",e),j.appendChild(k),this.sheetWidth=c.offsetWidth,this.sheetHeight=c.offsetHeight,this.clonelimiteWidth=Math.sqrt(this.sheetWidth*this.sheetWidth+this.sheetHeight*this.sheetHeight),this.clonelimiteHeight=this.sheetHeight;var l=Math.acos(this.sheetWidth/this.clonelimiteWidth);this.deg=l*(180/Math.PI);var m=100*this.sheetWidth/this.sheetHeight/100;this.translateX=this.translateY=0;var n,o;switch(d){case"1":c.setAttribute("class","sheet topleftfolding"),n=-this.deg,o=this.deg,this.translateX=-m,this.translateY=1,g.style.borderBottomWidth=this.sheetHeight+"px",g.style.borderLeftWidth=this.sheetWidth+"px";break;case"2":c.setAttribute("class","sheet toprightfolding"),n=this.deg,o=-this.deg,this.translateX=m,this.translateY=1,g.style.borderBottomWidth=this.sheetHeight+"px",g.style.borderRightWidth=this.sheetWidth+"px";break;case"3":c.setAttribute("class","sheet bottomrightfolding"),n=-this.deg,o=this.deg,this.translateX=-m,this.translateY=1,g.style.borderTopWidth=this.sheetHeight+"px",g.style.borderRightWidth=this.sheetWidth+"px";break;case"4":c.setAttribute("class","sheet bottomleftfolding"),n=this.deg,o=-this.deg,this.translateX=m,this.translateY=1,g.style.borderTopWidth=this.sheetHeight+"px",g.style.borderLeftWidth=this.sheetWidth+"px";break;case"5":c.setAttribute("class","sheet leftfolding"),n=0,o=0,this.translateX=0,this.translateY=1,this.clonelimiteWidth=this.sheetWidth/2,g.style.borderLeftWidth=this.sheetWidth/2+"px";break;case"6":c.setAttribute("class","sheet rightfolding"),n=0,o=0,this.translateX=0,this.translateY=-1,this.clonelimiteWidth=this.sheetWidth/2,g.style.borderRightWidth=this.sheetWidth/2+"px";break;case"7":c.setAttribute("class","sheet topfolding"),n=0,o=0,this.translateX=1,this.translateY=0,this.clonelimiteWidth=this.sheetWidth,this.clonelimiteHeight=this.sheetHeight/2;break;case"8":c.setAttribute("class","sheet bottomfolding"),n=0,o=0,this.translateX=-1,this.translateY=0,this.clonelimiteWidth=this.sheetWidth,this.clonelimiteHeight=this.sheetHeight/2}h.style.width=this.clonelimiteWidth+"px",h.style.height=this.clonelimiteHeight+"px",b.updateRotate(this.clonelimite,n),i.style.width=j.style.width=this.sheetWidth+"px",i.style.height=j.style.height=this.sheetHeight+"px",b.updateRotate(this.clonerotate,o),b.updateRotate3d(this.clone,this.translateX,this.translateY)}})}};!function(){var a=document.getElementsByClassName("origami");Array.prototype.forEach.call(a,function(a){var b=new Origami(a);b.init(),setTimeout(function(){b.closeAll()},2e3)})}();